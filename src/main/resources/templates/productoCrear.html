<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerubines App - Crear Producto</title>
    <link rel="stylesheet" th:href="@{/css/productoStyle.css}"> <!-- Estilos base del sistema -->
    <link rel="stylesheet" th:href="@{/css/productoTabla.css}"> <!-- Estilos específicos de la tabla -->
</head>
<body>
<!-- Header -->
<header class="header">
    <div class="header-left">
        <button class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1 class="logo"><a href="/">Kerubines App</a></h1>
    </div>
    <div class="header-right">
        <div class="user-menu">
            <button class="user-button" id="userButton">
                <svg class="user-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6,9 12,15 18,9"></polyline>
                </svg>
            </button>
            <div class="dropdown-menu" id="dropdownMenu">
                <form action="/logout" method="post" style="margin: 0; padding: 0;">
                    <button type="submit" class="dropdown-item logout">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16,17 21,12 16,7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                        Cerrar Sesión
                    </button>
                </form>
            </div>
        </div>
    </div>
</header>

<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
    <nav class="sidebar-nav">
        <!-- Venta Section -->
        <div class="nav-section">
            <button class="nav-item nav-toggle" data-target="ventaSubmenu">
                <div class="nav-item-content">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3h18v18H3zM9 9h6v6H9z"></path>
                    </svg>
                    <span>Venta</span>
                </div>
                <svg class="nav-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
            </button>
            <div class="nav-submenu" id="ventaSubmenu">
                <a href="#" class="nav-subitem" th:href="@{/venta/crear}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Crear
                </a>
                <a href="#" class="nav-subitem" th:href="@{/venta/administrar}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                    </svg>
                    Administrar
                </a>
            </div>
        </div>
        <!-- Usuarios Section -->
        <div class="nav-section">
            <button class="nav-item nav-toggle" data-target="usuariosSubmenu">
                <div class="nav-item-content">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span>Usuarios</span>
                </div>
                <svg class="nav-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
            </button>
            <div class="nav-submenu" id="usuariosSubmenu">
                <a href="#" class="nav-subitem" th:href="@{/register}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Crear
                </a>
                <a href="#" class="nav-subitem" th:href="@{/usuarios/administrar}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                    </svg>
                    Administrar
                </a>
            </div>
        </div>
        <!-- Productos Section -->
        <div class="nav-section">
            <button class="nav-item nav-toggle" data-target="productosSubmenu">
                <div class="nav-item-content">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                    </svg>
                    <span>Productos</span>
                </div>
                <svg class="nav-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
            </button>
            <div class="nav-submenu" id="productosSubmenu">
                <a href="#" class="nav-subitem active" th:href="@{/productos/crear}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Crear
                </a>
                <a href="#" class="nav-subitem" th:href="@{/productos/administrar}">
                    <svg class="nav-subicon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                    </svg>
                    Administrar
                </a>
            </div>
        </div>
    </nav>
</aside>

<!-- Main Content -->
<main class="main-content" id="mainContent">
    <div class="content-wrapper">
        <div class="page-header">
            <h2 class="page-title">Crear Nuevo Producto</h2>
            <p class="page-description">Completa la información del producto para agregarlo al inventario</p>
        </div>
        <div class="form-container" >
            <form id="productForm" th:action="@{/productos/crear/post}" th:object="${productoEntidad}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <div class="form-grid">
                    <!-- Nombre del producto -->
                    <div class="form-group">
                        <label for="nombreProducto" class="form-label required">Nombre del Producto</label>
                        <input
                                type="text"
                                id="nombreProducto"
                                th:field="*{nombreProducto}"
                                class="form-input"
                                placeholder="Ingresa el nombre del producto"
                                required
                        >
                    </div>
                    <!-- Talla, Costo y Stock en la misma fila -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="talla" class="form-label required">Talla</label>
                            <input
                                    type="text"
                                    id="talla"
                                    th:field="*{talla}"
                                    class="form-input"
                                    placeholder="Ej: M, L, XL, 32, Única"
                                    required
                            >
                        </div>
                        <div class="form-group">
                            <label for="costo" class="form-label required">Costo</label>
                            <input
                                    type="number"
                                    id="costo"
                                    th:field="*{costo}"
                                    class="form-input"
                                    placeholder="0.00"
                                    step="0.01"
                                    min="0"
                                    required
                            >
                        </div>
                        <div class="form-group">
                            <label for="stock" class="form-label required">Stock</label>
                            <input
                                    type="number"
                                    id="stock"
                                    th:field="*{stock}"
                                    class="form-input"
                                    placeholder="0"
                                    min="0"
                                    step="1"
                                    required
                            >
                        </div>
                    </div>
                    <!-- Color -->
                    <div class="form-group">
                        <label for="color" class="form-label required">Color</label>
                        <div class="color-input-wrapper">
                            <input
                                    type="color"
                                    id="colorPicker"
                                    name="colorPicker"
                                    class="color-picker"
                                    value="#000000"
                            >
                            <input
                                    type="text"
                                    id="color"
                                    th:field="*{color}"
                                    class="form-input"
                                    placeholder="Nombre del color"
                                    style="flex: 1;"
                                    required
                            >
                        </div>
                    </div>
                    <!-- Descripción -->
                    <div class="form-group">
                        <label for="descripcion" class="form-label">Descripción</label>
                        <textarea
                                id="descripcion"
                                th:field="*{descripcion}"
                                class="form-textarea"
                                placeholder="Describe las características del producto (opcional)"
                                rows="4"
                        ></textarea>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17,21 17,13 7,13 7,21"></polyline>
                            <polyline points="7,3 7,8 15,8"></polyline>
                        </svg>
                        Guardar Producto
                    </button>
                </div>
            </form>
        </div>
    </div>
</main>

<!-- Overlay for mobile -->
<div class="overlay" id="overlay"></div>

<script>
    // Toggle sidebar
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    const overlay = document.getElementById('overlay');

    menuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
        document.body.classList.toggle('sidebar-open');
    });

    overlay.addEventListener('click', () => {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
        document.body.classList.remove('sidebar-open');
    });

    // Toggle user dropdown
    const userButton = document.getElementById('userButton');
    const dropdownMenu = document.getElementById('dropdownMenu');

    userButton.addEventListener('click', (e) => {
        e.stopPropagation();
        dropdownMenu.classList.toggle('active');
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', () => {
        dropdownMenu.classList.remove('active');
    });

    dropdownMenu.addEventListener('click', (e) => {
        e.stopPropagation();
    });

    // Toggle navigation submenus
    const navToggles = document.querySelectorAll('.nav-toggle');
    navToggles.forEach(toggle => {
        toggle.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = toggle.getAttribute('data-target');
            const submenu = document.getElementById(targetId);
            const chevron = toggle.querySelector('.nav-chevron');

            // Close other submenus
            navToggles.forEach(otherToggle => {
                if (otherToggle !== toggle) {
                    const otherTargetId = otherToggle.getAttribute('data-target');
                    const otherSubmenu = document.getElementById(otherTargetId);
                    const otherChevron = otherToggle.querySelector('.nav-chevron');
                    otherSubmenu.classList.remove('active');
                    otherToggle.classList.remove('active');
                    otherChevron.style.transform = 'rotate(0deg)';
                }
            });

            // Toggle current submenu
            submenu.classList.toggle('active');
            toggle.classList.toggle('active');
            if (submenu.classList.contains('active')) {
                chevron.style.transform = 'rotate(90deg)';
            } else {
                chevron.style.transform = 'rotate(0deg)';
            }
        });
    });

    // Handle submenu item clicks
    const subItems = document.querySelectorAll('.nav-subitem');
    subItems.forEach(item => {
        item.addEventListener('click', () => {
            // Remove active class from all subitems
            subItems.forEach(subItem => subItem.classList.remove('active'));
            // Add active class to clicked item
            item.classList.add('active');
        });
    });

    // Color picker functionality
    const colorPicker = document.getElementById('colorPicker');
    const colorInput = document.getElementById('color');

    colorPicker.addEventListener('change', (e) => {
        const hexColor = e.target.value;
        // Convert hex to color name (simplified)
        const colorNames = {
            '#000000': 'Negro',
            '#ffffff': 'Blanco',
            '#ff0000': 'Rojo',
            '#00ff00': 'Verde',
            '#0000ff': 'Azul',
            '#ffff00': 'Amarillo',
            '#ff00ff': 'Magenta',
            '#00ffff': 'Cian',
            '#808080': 'Gris',
            '#800000': 'Marrón',
            '#008000': 'Verde Oscuro',
            '#000080': 'Azul Marino',
            '#808000': 'Oliva',
            '#800080': 'Púrpura',
            '#008080': 'Verde Azulado'
        };
        colorInput.value = colorNames[hexColor] || hexColor;
    });

    // Form submission


    // Cancel button functionality
    const cancelButton = document.querySelector('.btn-secondary');
    cancelButton.addEventListener('click', () => {
        if (confirm('¿Estás seguro de que quieres cancelar? Se perderán los datos ingresados.')) {
            productForm.reset();
            colorInput.value = '';
            colorPicker.value = '#000000';
            // You could also redirect to another page here
            // window.location.href = '/productos/administrar';
        }
    });

    // Initialize the products submenu as active on page load
    document.addEventListener('DOMContentLoaded', () => {
        const productosToggle = document.querySelector('[data-target="productosSubmenu"]');
        const productosSubmenu = document.getElementById('productosSubmenu');
        const productosChevron = productosToggle.querySelector('.nav-chevron');

        // Forzar la apertura del submenú de Productos
        productosSubmenu.classList.add('active');
        productosToggle.classList.add('active');
        productosChevron.style.transform = 'rotate(90deg)';

        // Marcar como activo el ítem "Crear" en el submenú
        const createItem = document.querySelector('a[th\\:href*="/productos/crear"]');
        if (createItem) {
            createItem.classList.add('active');
        }
    });
</script>
</body>
</html>